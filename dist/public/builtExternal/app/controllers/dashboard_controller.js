define(['app/base', 'angularjs', 'fbase'], function(TimeSheetApp) {
  var DashBoardController;
  DashBoardController = (function() {
    function DashBoardController($scope, $rootScope, $sce, FirebaseService, $window, $firebaseObject, $firebaseArray) {
      $scope.moment = moment;
      $scope.startDate = moment({
        year: 2015,
        month: 6,
        day: 2
      }).add(Math.floor((moment().diff(moment({
        year: 2015,
        month: 6,
        day: 2
      }), 'days')) / 14) * 13, 'd');
      $scope.endDate = moment({
        year: 2015,
        month: 6,
        day: 2
      }).add(Math.ceil((moment().diff(moment({
        year: 2015,
        month: 6,
        day: 2
      }), 'days')) / 14) * 13, 'd');
      $scope.formattedStart = $scope.startDate.format('M/D/YY');
      $scope.formattedEnd = $scope.endDate.format('M/D/YY');
      $scope.currentTimeSheetKey = (moment($scope.formattedStart, 'M/D/YY').format("MMMM Do YYYY")) + "-" + (moment($scope.formattedEnd, 'M/D/YY').format("MMMM Do YYYY"));
      $scope.currentPayPeriod = (moment($scope.formattedStart, 'M/D/YY').format("MMMM Do YYYY")) + "-" + (moment($scope.formattedEnd, 'M/D/YY').format("MMMM Do YYYY"));
      $scope.lessonModel = {
        student: "",
        length: "",
        notes: ""
      };
      FirebaseService.rootRef.child('students').once("value", function(snap) {
        var k, students, v, _ref;
        students = [];
        _ref = snap.val();
        for (k in _ref) {
          v = _ref[k];
          students.push({
            id: k,
            name: v.firstName + " " + v.lastName,
            parent: v.parent
          });
        }
        return $scope.$apply(function() {
          return $scope.students = students;
        });
      });
      $rootScope.$watch('userBasic', function(newVal, oldVal) {
        if ($rootScope.userBasic) {
          if (!($rootScope.userBasic.manager || $rootScope.userBasic.mentor)) {
            return $rootScope.roleNotSet = true;
          } else {
            return $scope.loadDashboard();
          }
        }
      });
      $scope.nextPeriod = function() {
        var oldEndDate;
        oldEndDate = $scope.endDate;
        $scope.startDate = oldEndDate;
        $scope.formattedStart = $scope.startDate.format('M/D/YY');
        $scope.endDate = $scope.startDate.add(13, 'd');
        $scope.formattedEnd = $scope.endDate.format('M/D/YY');
        $scope.currentTimeSheetKey = (moment($scope.formattedStart, 'M/D/YY').format("MMMM Do YYYY")) + "-" + (moment($scope.formattedEnd, 'M/D/YY').format("MMMM Do YYYY"));
        $scope.reRenderDatePicker();
        if ($scope.currentDash === 'Mentor') {
          if ($scope.currentTimeSheet) {
            $scope.currentTimeSheet.$destroy();
          }
          $scope.currentTimeSheet = $firebaseObject($rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/lessons"));
          return $scope.currentTimeSheetSubmitted = $firebaseObject($rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/submitted"));
        }
      };
      $scope.prevPeriod = function() {
        $scope.startDate = moment($scope.formattedStart, 'M/D/YY').subtract(13, 'd');
        $scope.formattedStart = $scope.startDate.format('M/D/YY');
        $scope.endDate = moment($scope.formattedEnd, 'M/D/YY').subtract(13, 'd');
        $scope.formattedEnd = $scope.endDate.format('M/D/YY');
        $scope.currentTimeSheetKey = (moment($scope.formattedStart, 'M/D/YY').format("MMMM Do YYYY")) + "-" + (moment($scope.formattedEnd, 'M/D/YY').format("MMMM Do YYYY"));
        $scope.reRenderDatePicker();
        if ($scope.currentDash === 'Mentor') {
          if ($scope.currentTimeSheet) {
            $scope.currentTimeSheet.$destroy();
          }
          $scope.currentTimeSheet = $firebaseObject($rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/lessons"));
          return $scope.currentTimeSheetSubmitted = $firebaseObject($rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/submitted"));
        }
      };
      $scope.reRenderDatePicker = function() {
        var maxDate, minDate;
        minDate = $scope.startDate.toDate();
        maxDate = $scope.endDate.toDate();
        $('#datepicker-01').datepicker("option", "maxDate", maxDate);
        $('#datepicker-01').datepicker("option", "minDate", minDate);
      };
      $scope.loadDashboard = function() {
        var datepickerSelector, maxDate, minDate;
        if ($rootScope.userBasic.manager) {
          $scope.selectedTab = 'TIMESHEETS';
          $scope.currentDash = 'Manager';
          return $scope.mentors = $firebaseObject(FirebaseService.rootRef.child('users').startAt('mentor').endAt('mentor'));
        } else {
          $scope.currentDash = 'Mentor';
          $scope.currentTimeSheet = $firebaseObject($rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/lessons"));
          $scope.currentTimeSheetSubmitted = $firebaseObject($rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/submitted"));
          minDate = $scope.startDate.toDate();
          maxDate = $scope.endDate.toDate();
          datepickerSelector = $('#datepicker-01');
          datepickerSelector.datepicker({
            showOtherMonths: true,
            selectOtherMonths: true,
            minDate: minDate,
            maxDate: maxDate,
            dateFormat: 'm/d/yy',
            yearRange: '-1:+1'
          }).prev('.input-group-btn').on('click', function(e) {
            e && e.preventDefault();
            datepickerSelector.focus();
          });
          $.extend($.datepicker, {
            _checkOffset: function(inst, offset, isFixed) {
              return offset;
            }
          });
          datepickerSelector.datepicker('widget').css({
            'margin-left': -datepickerSelector.prev('.input-group-btn').find('.btn').outerWidth() + 3
          });
          return $scope.reRenderDatePicker();
        }
      };
      $scope.openTimesheetsTab = function() {
        return $scope.selectedTab = 'TIMESHEETS';
      };
      $scope.formatLabel = function(item) {
        if (item) {
          return item.name;
        }
      };
      $scope.openInvoicesTab = function() {
        $scope.selectedTab = 'INVOICES';
        return $scope.parents = $firebaseObject($rootScope.rootRef.child("parents"));
      };
      $scope.addLesson = function() {
        if ($scope.lessonModel.student.id && $scope.lessonModel.length.length > 0 && $('#datepicker-01').val().length > 0) {
          $scope.lessonModel.date = moment($('#datepicker-01').val(), 'M/D/YYYY').format("MMMM Do YYYY");
          $rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/lessons").push().set($scope.lessonModel);
          return $scope.lessonModel = {
            student: "",
            length: "",
            notes: ""
          };
        }
      };
      $scope.removeLesson = function(id) {
        return $rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/lessons/" + id).set(null);
      };
      $scope.submitTimeSheet = function() {
        var result, totalTime;
        result = confirm("Are you sure?");
        if (result) {
          $rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/submitted").set(true);
          totalTime = 0.00;
          angular.forEach($scope.currentTimeSheet, function(value, key) {
            totalTime = totalTime + parseFloat(value.length);
            return $rootScope.rootRef.child("parents/" + value.student.parent.parentId + "/invoices/" + $scope.currentTimeSheetKey).push().set({
              date: value.date,
              studentName: value.student.name,
              length: value.length,
              notes: value.notes,
              mentorId: $rootScope.currentUid,
              mentorName: $rootScope.userBasic.firstName + " " + $rootScope.userBasic.lastName
            });
          });
          $rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey + "/totalTime").set(totalTime);
          return $rootScope.currentUserRef.child("timesheets/" + $scope.currentTimeSheetKey).setPriority('submitted');
        }
      };
      $scope.manageMentor = function(userid, mentor) {
        $scope.showManageMentor = true;
        return $scope.showManageMentorObj = mentor;
      };
      $scope.calculateTotalHoursForAParent = function(lessons) {
        var k, totalHours, v;
        totalHours = 0;
        for (k in lessons) {
          v = lessons[k];
          totalHours = parseFloat(v.length) + totalHours;
        }
        return totalHours;
      };
      $scope.manageParent = function(userid, parent) {
        $scope.showManageParent = true;
        return $scope.showManageParentObj = parent;
      };
      $scope.checkCurrentPayPeriod = function() {
        return moment().isBetween($scope.startDate, $scope.endDate);
      };
    }

    return DashBoardController;

  })();
  DashBoardController.$inject = ["$scope", "$rootScope", "$sce", "FirebaseService", "$window", "$firebaseObject", "$firebaseArray"];
  TimeSheetApp.controller('DashBoardController', DashBoardController);
  return DashBoardController;
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2tyaXNobmFyb2toYWxlL2NvZGUvbGV2ZWwvbGV2ZWwvdGltZXNoZWV0YXBwL3B1YmxpYy9qYXZhc2NyaXB0cy9hcHAvY29udHJvbGxlcnMvZGFzaGJvYXJkX2NvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIvVXNlcnMva3Jpc2huYXJva2hhbGUvY29kZS9sZXZlbC9sZXZlbC90aW1lc2hlZXRhcHAvYXNzZXRzL2phdmFzY3JpcHRzL2FwcC9jb250cm9sbGVycy9kYXNoYm9hcmRfY29udHJvbGxlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBQSxDQUFPLENBQUUsVUFBRixFQUFhLFdBQWIsRUFBMEIsT0FBMUIsQ0FBUCxFQUEwQyxTQUFDLFlBQUQsR0FBQTtBQUV4QyxNQUFBLG1CQUFBO0FBQUEsRUFBTTtBQUVTLElBQUEsNkJBQUMsTUFBRCxFQUFTLFVBQVQsRUFBcUIsSUFBckIsRUFBMkIsZUFBM0IsRUFBNEMsT0FBNUMsRUFBcUQsZUFBckQsRUFBc0UsY0FBdEUsR0FBQTtBQUVYLE1BQUEsTUFBTSxDQUFDLE1BQVAsR0FBZ0IsTUFBaEIsQ0FBQTtBQUFBLE1BQ0EsTUFBTSxDQUFDLFNBQVAsR0FBbUIsTUFBQSxDQUFPO0FBQUEsUUFBRSxJQUFBLEVBQU0sSUFBUjtBQUFBLFFBQWMsS0FBQSxFQUFPLENBQXJCO0FBQUEsUUFBd0IsR0FBQSxFQUFLLENBQTdCO09BQVAsQ0FBdUMsQ0FBQyxHQUF4QyxDQUE0QyxJQUFJLENBQUMsS0FBTCxDQUFXLENBQUMsTUFBQSxDQUFBLENBQVEsQ0FBQyxJQUFULENBQWMsTUFBQSxDQUFPO0FBQUEsUUFBRSxJQUFBLEVBQU0sSUFBUjtBQUFBLFFBQWMsS0FBQSxFQUFPLENBQXJCO0FBQUEsUUFBd0IsR0FBQSxFQUFLLENBQTdCO09BQVAsQ0FBZCxFQUF3RCxNQUF4RCxDQUFELENBQUEsR0FBaUUsRUFBNUUsQ0FBQSxHQUFnRixFQUE1SCxFQUFpSSxHQUFq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QUFDLFNBQTFCLEVBQXFDLE1BQU0sQ0FBQyxPQUE1QyxFQUQ2QjtNQUFBLENBL0ovQixDQUZXO0lBQUEsQ0FBYjs7K0JBQUE7O01BRkYsQ0FBQTtBQUFBLEVBeUtBLG1CQUFtQixDQUFDLE9BQXBCLEdBQThCLENBQUUsUUFBRixFQUFZLFlBQVosRUFBMEIsTUFBMUIsRUFBa0MsaUJBQWxDLEVBQXFELFNBQXJELEVBQWdFLGlCQUFoRSxFQUFtRixnQkFBbkYsQ0F6SzlCLENBQUE7QUFBQSxFQTJLQSxZQUFZLENBQUMsVUFBYixDQUF5QixxQkFBekIsRUFBK0MsbUJBQS9DLENBM0tBLENBQUE7U0E2S0Esb0JBL0t3QztBQUFBLENBQTFDLENBQUEsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImRlZmluZSBbJ2FwcC9iYXNlJywnYW5ndWxhcmpzJywgJ2ZiYXNlJ10sIChUaW1lU2hlZXRBcHApIC0+XG5cbiAgY2xhc3MgRGFzaEJvYXJkQ29udHJvbGxlclxuXG4gICAgY29uc3RydWN0b3I6ICgkc2NvcGUsICRyb290U2NvcGUsICRzY2UsIEZpcmViYXNlU2VydmljZSwgJHdpbmRvdywgJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSkgLT5cblxuICAgICAgJHNjb3BlLm1vbWVudCA9IG1vbWVudFxuICAgICAgJHNjb3BlLnN0YXJ0RGF0ZSA9IG1vbWVudCh7IHllYXIgOjIwMTUsIG1vbnRoIDo2LCBkYXkgOjJ9KS5hZGQoTWF0aC5mbG9vcigobW9tZW50KCkuZGlmZihtb21lbnQoeyB5ZWFyIDoyMDE1LCBtb250aCA6NiwgZGF5IDoyfSksICdkYXlzJykpLzE0KSoxMywgJ2QnKVxuICAgICAgJHNjb3BlLmVuZERhdGUgPSBtb21lbnQoeyB5ZWFyIDoyMDE1LCBtb250aCA6NiwgZGF5IDoyfSkuYWRkKE1hdGguY2VpbCgobW9tZW50KCkuZGlmZihtb21lbnQoeyB5ZWFyIDoyMDE1LCBtb250aCA6NiwgZGF5IDoyfSksICdkYXlzJykpLzE0KSoxMywgJ2QnKVxuXG5cbiAgICAgICRzY29wZS5mb3JtYXR0ZWRTdGFydCA9ICRzY29wZS5zdGFydERhdGUuZm9ybWF0KCdNL0QvWVknKVxuICAgICAgJHNjb3BlLmZvcm1hdHRlZEVuZCA9ICRzY29wZS5lbmREYXRlLmZvcm1hdCgnTS9EL1lZJylcblxuICAgICAgJHNjb3BlLmN1cnJlbnRUaW1lU2hlZXRLZXkgPSBcIiN7bW9tZW50KCRzY29wZS5mb3JtYXR0ZWRTdGFydCwgJ00vRC9ZWScpLmZvcm1hdChcIk1NTU0gRG8gWVlZWVwiKX0tI3ttb21lbnQoJHNjb3BlLmZvcm1hdHRlZEVuZCwgJ00vRC9ZWScpLmZvcm1hdChcIk1NTU0gRG8gWVlZWVwiKX1cIlxuICAgICAgJHNjb3BlLmN1cnJlbnRQYXlQZXJpb2QgPSBcIiN7bW9tZW50KCRzY29wZS5mb3JtYXR0ZWRTdGFydCwgJ00vRC9ZWScpLmZvcm1hdChcIk1NTU0gRG8gWVlZWVwiKX0tI3ttb21lbnQoJHNjb3BlLmZvcm1hdHRlZEVuZCwgJ00vRC9ZWScpLmZvcm1hdChcIk1NTU0gRG8gWVlZWVwiKX1cIlxuXG5cbiAgICAgICRzY29wZS5sZXNzb25Nb2RlbCA9IHtzdHVkZW50OiBcIlwiLCBsZW5ndGg6IFwiXCIsIG5vdGVzOiBcIlwifVxuXG4gICAgICBGaXJlYmFzZVNlcnZpY2Uucm9vdFJlZi5jaGlsZCgnc3R1ZGVudHMnKS5vbmNlIFwidmFsdWVcIiwgKHNuYXApIC0+XG4gICAgICAgIHN0dWRlbnRzID0gW11cbiAgICAgICAgZm9yIGssdiBvZiBzbmFwLnZhbCgpXG4gICAgICAgICAgc3R1ZGVudHMucHVzaCB7aWQ6IGssIG5hbWU6IFwiI3t2LmZpcnN0TmFtZX0gI3t2Lmxhc3ROYW1lfVwiLCBwYXJlbnQ6IHYucGFyZW50fVxuXG4gICAgICAgICRzY29wZS4kYXBwbHkgLT5cbiAgICAgICAgICAkc2NvcGUuc3R1ZGVudHMgPSBzdHVkZW50c1xuXG5cbiAgICAgICRyb290U2NvcGUuJHdhdGNoICd1c2VyQmFzaWMnLCAobmV3VmFsLCBvbGRWYWwpIC0+XG4gICAgICAgIGlmICRyb290U2NvcGUudXNlckJhc2ljXG4gICAgICAgICAgdW5sZXNzICRyb290U2NvcGUudXNlckJhc2ljLm1hbmFnZXIgfHwgJHJvb3RTY29wZS51c2VyQmFzaWMubWVudG9yXG4gICAgICAgICAgICAkcm9vdFNjb3BlLnJvbGVOb3RTZXQgPSB0cnVlXG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgJHNjb3BlLmxvYWREYXNoYm9hcmQoKVxuXG5cblxuICAgICAgJHNjb3BlLm5leHRQZXJpb2QgPSAoKSAtPlxuICAgICAgICBvbGRFbmREYXRlID0gJHNjb3BlLmVuZERhdGVcbiAgICAgICAgJHNjb3BlLnN0YXJ0RGF0ZSA9IG9sZEVuZERhdGVcbiAgICAgICAgJHNjb3BlLmZvcm1hdHRlZFN0YXJ0ID0gJHNjb3BlLnN0YXJ0RGF0ZS5mb3JtYXQoJ00vRC9ZWScpXG5cbiAgICAgICAgJHNjb3BlLmVuZERhdGUgPSAkc2NvcGUuc3RhcnREYXRlLmFkZCgxMywgJ2QnKVxuICAgICAgICAkc2NvcGUuZm9ybWF0dGVkRW5kID0gJHNjb3BlLmVuZERhdGUuZm9ybWF0KCdNL0QvWVknKVxuXG4gICAgICAgICRzY29wZS5jdXJyZW50VGltZVNoZWV0S2V5ID0gXCIje21vbWVudCgkc2NvcGUuZm9ybWF0dGVkU3RhcnQsICdNL0QvWVknKS5mb3JtYXQoXCJNTU1NIERvIFlZWVlcIil9LSN7bW9tZW50KCRzY29wZS5mb3JtYXR0ZWRFbmQsICdNL0QvWVknKS5mb3JtYXQoXCJNTU1NIERvIFlZWVlcIil9XCJcblxuICAgICAgICAkc2NvcGUucmVSZW5kZXJEYXRlUGlja2VyKClcblxuICAgICAgICBpZiAkc2NvcGUuY3VycmVudERhc2ggPT0gJ01lbnRvcidcbiAgICAgICAgICAkc2NvcGUuY3VycmVudFRpbWVTaGVldC4kZGVzdHJveSgpIGlmICRzY29wZS5jdXJyZW50VGltZVNoZWV0XG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRUaW1lU2hlZXQgPSAkZmlyZWJhc2VPYmplY3QoJHJvb3RTY29wZS5jdXJyZW50VXNlclJlZi5jaGlsZChcInRpbWVzaGVldHMvI3skc2NvcGUuY3VycmVudFRpbWVTaGVldEtleX0vbGVzc29uc1wiKSlcbiAgICAgICAgICAkc2NvcGUuY3VycmVudFRpbWVTaGVldFN1Ym1pdHRlZCA9ICRmaXJlYmFzZU9iamVjdCgkcm9vdFNjb3BlLmN1cnJlbnRVc2VyUmVmLmNoaWxkKFwidGltZXNoZWV0cy8jeyRzY29wZS5jdXJyZW50VGltZVNoZWV0S2V5fS9zdWJtaXR0ZWRcIikpXG5cblxuICAgICAgJHNjb3BlLnByZXZQZXJpb2QgPSAoKSAtPlxuICAgICAgICAkc2NvcGUuc3RhcnREYXRlID0gbW9tZW50KCRzY29wZS5mb3JtYXR0ZWRTdGFydCwgJ00vRC9ZWScpLnN1YnRyYWN0KDEzLCAnZCcpXG4gICAgICAgICRzY29wZS5mb3JtYXR0ZWRTdGFydCA9ICRzY29wZS5zdGFydERhdGUuZm9ybWF0KCdNL0QvWVknKVxuXG4gICAgICAgICRzY29wZS5lbmREYXRlID0gbW9tZW50KCRzY29wZS5mb3JtYXR0ZWRFbmQsICdNL0QvWVknKS5zdWJ0cmFjdCgxMywgJ2QnKVxuICAgICAgICAkc2NvcGUuZm9ybWF0dGVkRW5kID0gJHNjb3BlLmVuZERhdGUuZm9ybWF0KCdNL0QvWVknKVxuXG4gICAgICAgICRzY29wZS5jdXJyZW50VGltZVNoZWV0S2V5ID0gXCIje21vbWVudCgkc2NvcGUuZm9ybWF0dGVkU3RhcnQsICdNL0QvWVknKS5mb3JtYXQoXCJNTU1NIERvIFlZWVlcIil9LSN7bW9tZW50KCRzY29wZS5mb3JtYXR0ZWRFbmQsICdNL0QvWVknKS5mb3JtYXQoXCJNTU1NIERvIFlZWVlcIil9XCJcblxuICAgICAgICAkc2NvcGUucmVSZW5kZXJEYXRlUGlja2VyKClcblxuICAgICAgICBpZiAkc2NvcGUuY3VycmVudERhc2ggPT0gJ01lbnRvcidcbiAgICAgICAgICAkc2NvcGUuY3VycmVudFRpbWVTaGVldC4kZGVzdHJveSgpIGlmICRzY29wZS5jdXJyZW50VGltZVNoZWV0XG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRUaW1lU2hlZXQgPSAkZmlyZWJhc2VPYmplY3QoJHJvb3RTY29wZS5jdXJyZW50VXNlclJlZi5jaGlsZChcInRpbWVzaGVldHMvI3skc2NvcGUuY3VycmVudFRpbWVTaGVldEtleX0vbGVzc29uc1wiKSlcbiAgICAgICAgICAkc2NvcGUuY3VycmVudFRpbWVTaGVldFN1Ym1pdHRlZCA9ICRmaXJlYmFzZU9iamVjdCgkcm9vdFNjb3BlLmN1cnJlbnRVc2VyUmVmLmNoaWxkKFwidGltZXNoZWV0cy8jeyRzY29wZS5jdXJyZW50VGltZVNoZWV0S2V5fS9zdWJtaXR0ZWRcIikpXG5cblxuICAgICAgJHNjb3BlLnJlUmVuZGVyRGF0ZVBpY2tlciA9ICgpIC0+XG4gICAgICAgIG1pbkRhdGUgPSAkc2NvcGUuc3RhcnREYXRlLnRvRGF0ZSgpXG4gICAgICAgIG1heERhdGUgPSAkc2NvcGUuZW5kRGF0ZS50b0RhdGUoKVxuICAgICAgICAkKCcjZGF0ZXBpY2tlci0wMScpLmRhdGVwaWNrZXIoIFwib3B0aW9uXCIsIFwibWF4RGF0ZVwiLCBtYXhEYXRlIClcbiAgICAgICAgJCgnI2RhdGVwaWNrZXItMDEnKS5kYXRlcGlja2VyKCBcIm9wdGlvblwiLCBcIm1pbkRhdGVcIiwgbWluRGF0ZSApXG4gICAgICAgIHJldHVyblxuXG5cbiAgICAgICRzY29wZS5sb2FkRGFzaGJvYXJkID0gKCkgLT5cbiAgICAgICAgaWYgJHJvb3RTY29wZS51c2VyQmFzaWMubWFuYWdlclxuICAgICAgICAgICRzY29wZS5zZWxlY3RlZFRhYiA9ICdUSU1FU0hFRVRTJ1xuICAgICAgICAgICRzY29wZS5jdXJyZW50RGFzaCA9ICdNYW5hZ2VyJ1xuICAgICAgICAgICRzY29wZS5tZW50b3JzID0gJGZpcmViYXNlT2JqZWN0KEZpcmViYXNlU2VydmljZS5yb290UmVmLmNoaWxkKCd1c2VycycpLnN0YXJ0QXQoJ21lbnRvcicpLmVuZEF0KCdtZW50b3InKSlcblxuICAgICAgICBlbHNlXG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnREYXNoID0gJ01lbnRvcidcblxuICAgICAgICAgICRzY29wZS5jdXJyZW50VGltZVNoZWV0ID0gJGZpcmViYXNlT2JqZWN0KCRyb290U2NvcGUuY3VycmVudFVzZXJSZWYuY2hpbGQoXCJ0aW1lc2hlZXRzLyN7JHNjb3BlLmN1cnJlbnRUaW1lU2hlZXRLZXl9L2xlc3NvbnNcIikpXG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRUaW1lU2hlZXRTdWJtaXR0ZWQgPSAkZmlyZWJhc2VPYmplY3QoJHJvb3RTY29wZS5jdXJyZW50VXNlclJlZi5jaGlsZChcInRpbWVzaGVldHMvI3skc2NvcGUuY3VycmVudFRpbWVTaGVldEtleX0vc3VibWl0dGVkXCIpKVxuXG4gICAgICAgICAgbWluRGF0ZSA9ICRzY29wZS5zdGFydERhdGUudG9EYXRlKClcbiAgICAgICAgICBtYXhEYXRlID0gJHNjb3BlLmVuZERhdGUudG9EYXRlKClcblxuICAgICAgICAgIGRhdGVwaWNrZXJTZWxlY3RvciA9ICQoJyNkYXRlcGlja2VyLTAxJylcbiAgICAgICAgICBkYXRlcGlja2VyU2VsZWN0b3IuZGF0ZXBpY2tlcihcbiAgICAgICAgICAgIHNob3dPdGhlck1vbnRoczogdHJ1ZVxuICAgICAgICAgICAgc2VsZWN0T3RoZXJNb250aHM6IHRydWVcbiAgICAgICAgICAgIG1pbkRhdGU6IG1pbkRhdGVcbiAgICAgICAgICAgIG1heERhdGU6IG1heERhdGVcbiAgICAgICAgICAgIGRhdGVGb3JtYXQ6ICdtL2QveXknXG4gICAgICAgICAgICB5ZWFyUmFuZ2U6ICctMTorMScpLnByZXYoJy5pbnB1dC1ncm91cC1idG4nKS5vbiAnY2xpY2snLCAoZSkgLT5cbiAgICAgICAgICAgICAgZSBhbmQgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICAgIGRhdGVwaWNrZXJTZWxlY3Rvci5mb2N1cygpXG4gICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICQuZXh0ZW5kICQuZGF0ZXBpY2tlciwgX2NoZWNrT2Zmc2V0OiAoaW5zdCwgb2Zmc2V0LCBpc0ZpeGVkKSAtPlxuICAgICAgICAgICAgb2Zmc2V0XG4gICAgICAgICAgZGF0ZXBpY2tlclNlbGVjdG9yLmRhdGVwaWNrZXIoJ3dpZGdldCcpLmNzcyAnbWFyZ2luLWxlZnQnOiAtZGF0ZXBpY2tlclNlbGVjdG9yLnByZXYoJy5pbnB1dC1ncm91cC1idG4nKS5maW5kKCcuYnRuJykub3V0ZXJXaWR0aCgpICsgM1xuXG4gICAgICAgICAgJHNjb3BlLnJlUmVuZGVyRGF0ZVBpY2tlcigpXG5cbiAgICAgICRzY29wZS5vcGVuVGltZXNoZWV0c1RhYiA9ICgpIC0+XG4gICAgICAgICRzY29wZS5zZWxlY3RlZFRhYiA9ICdUSU1FU0hFRVRTJ1xuXG5cbiAgICAgICRzY29wZS5mb3JtYXRMYWJlbCA9IChpdGVtKSAtPlxuICAgICAgICBpdGVtLm5hbWUgaWYgaXRlbVxuXG5cbiAgICAgICRzY29wZS5vcGVuSW52b2ljZXNUYWIgPSAoKSAtPlxuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRUYWIgPSAnSU5WT0lDRVMnXG4gICAgICAgICRzY29wZS5wYXJlbnRzID0gJGZpcmViYXNlT2JqZWN0KCRyb290U2NvcGUucm9vdFJlZi5jaGlsZChcInBhcmVudHNcIikpXG5cblxuICAgICAgJHNjb3BlLmFkZExlc3NvbiA9ICgpIC0+XG4gICAgICAgIGlmICRzY29wZS5sZXNzb25Nb2RlbC5zdHVkZW50LmlkIGFuZCAkc2NvcGUubGVzc29uTW9kZWwubGVuZ3RoLmxlbmd0aCA+IDAgYW5kICQoJyNkYXRlcGlja2VyLTAxJykudmFsKCkubGVuZ3RoID4gMFxuICAgICAgICAgICRzY29wZS5sZXNzb25Nb2RlbC5kYXRlID0gbW9tZW50KCQoJyNkYXRlcGlja2VyLTAxJykudmFsKCksICdNL0QvWVlZWScpLmZvcm1hdChcIk1NTU0gRG8gWVlZWVwiKVxuICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXJSZWYuY2hpbGQoXCJ0aW1lc2hlZXRzLyN7JHNjb3BlLmN1cnJlbnRUaW1lU2hlZXRLZXl9L2xlc3NvbnNcIikucHVzaCgpLnNldCAkc2NvcGUubGVzc29uTW9kZWxcbiAgICAgICAgICAkc2NvcGUubGVzc29uTW9kZWwgPSB7c3R1ZGVudDogXCJcIiwgbGVuZ3RoOiBcIlwiLCBub3RlczogXCJcIn1cblxuICAgICAgJHNjb3BlLnJlbW92ZUxlc3NvbiA9IChpZCkgLT5cbiAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlclJlZi5jaGlsZChcInRpbWVzaGVldHMvI3skc2NvcGUuY3VycmVudFRpbWVTaGVldEtleX0vbGVzc29ucy8je2lkfVwiKS5zZXQgbnVsbFxuXG4gICAgICAkc2NvcGUuc3VibWl0VGltZVNoZWV0ID0gKCkgLT5cbiAgICAgICAgcmVzdWx0ID0gY29uZmlybShcIkFyZSB5b3Ugc3VyZT9cIilcbiAgICAgICAgaWYgcmVzdWx0XG4gICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlclJlZi5jaGlsZChcInRpbWVzaGVldHMvI3skc2NvcGUuY3VycmVudFRpbWVTaGVldEtleX0vc3VibWl0dGVkXCIpLnNldCB0cnVlXG5cbiAgICAgICAgICB0b3RhbFRpbWUgPSAwLjAwXG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoICRzY29wZS5jdXJyZW50VGltZVNoZWV0LCAodmFsdWUsIGtleSkgLT5cbiAgICAgICAgICAgIHRvdGFsVGltZSA9IHRvdGFsVGltZSArIHBhcnNlRmxvYXQodmFsdWUubGVuZ3RoKVxuICAgICAgICAgICAgJHJvb3RTY29wZS5yb290UmVmLmNoaWxkKFwicGFyZW50cy8je3ZhbHVlLnN0dWRlbnQucGFyZW50LnBhcmVudElkfS9pbnZvaWNlcy8jeyRzY29wZS5jdXJyZW50VGltZVNoZWV0S2V5fVwiKS5wdXNoKCkuc2V0IHtkYXRlOiB2YWx1ZS5kYXRlLCBzdHVkZW50TmFtZTogdmFsdWUuc3R1ZGVudC5uYW1lLCBsZW5ndGg6IHZhbHVlLmxlbmd0aCwgbm90ZXM6IHZhbHVlLm5vdGVzLCBtZW50b3JJZDogJHJvb3RTY29wZS5jdXJyZW50VWlkLCBtZW50b3JOYW1lOiBcIiN7JHJvb3RTY29wZS51c2VyQmFzaWMuZmlyc3ROYW1lfSAjeyRyb290U2NvcGUudXNlckJhc2ljLmxhc3ROYW1lfVwifVxuXG4gICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlclJlZi5jaGlsZChcInRpbWVzaGVldHMvI3skc2NvcGUuY3VycmVudFRpbWVTaGVldEtleX0vdG90YWxUaW1lXCIpLnNldCB0b3RhbFRpbWVcbiAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyUmVmLmNoaWxkKFwidGltZXNoZWV0cy8jeyRzY29wZS5jdXJyZW50VGltZVNoZWV0S2V5fVwiKS5zZXRQcmlvcml0eSAnc3VibWl0dGVkJ1xuXG5cbiAgICAgICRzY29wZS5tYW5hZ2VNZW50b3IgPSAodXNlcmlkLCBtZW50b3IpIC0+XG4gICAgICAgICRzY29wZS5zaG93TWFuYWdlTWVudG9yID0gdHJ1ZVxuICAgICAgICAkc2NvcGUuc2hvd01hbmFnZU1lbnRvck9iaiA9IG1lbnRvclxuXG5cbiAgICAgICRzY29wZS5jYWxjdWxhdGVUb3RhbEhvdXJzRm9yQVBhcmVudCA9IChsZXNzb25zKSAtPlxuICAgICAgICB0b3RhbEhvdXJzID0gMFxuICAgICAgICBmb3Igayx2IG9mIGxlc3NvbnNcbiAgICAgICAgICB0b3RhbEhvdXJzID0gcGFyc2VGbG9hdCh2Lmxlbmd0aCkgKyB0b3RhbEhvdXJzXG4gICAgICAgIHRvdGFsSG91cnNcblxuICAgICAgJHNjb3BlLm1hbmFnZVBhcmVudCA9ICh1c2VyaWQsIHBhcmVudCkgLT5cbiAgICAgICAgJHNjb3BlLnNob3dNYW5hZ2VQYXJlbnQgPSB0cnVlXG4gICAgICAgICRzY29wZS5zaG93TWFuYWdlUGFyZW50T2JqID0gcGFyZW50XG5cblxuICAgICAgJHNjb3BlLmNoZWNrQ3VycmVudFBheVBlcmlvZCA9ICgpIC0+XG4gICAgICAgIG1vbWVudCgpLmlzQmV0d2Vlbigkc2NvcGUuc3RhcnREYXRlLCAkc2NvcGUuZW5kRGF0ZSlcblxuXG5cblxuICBEYXNoQm9hcmRDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJHNjZVwiLCBcIkZpcmViYXNlU2VydmljZVwiLCBcIiR3aW5kb3dcIiwgXCIkZmlyZWJhc2VPYmplY3RcIiwgXCIkZmlyZWJhc2VBcnJheVwiXVxuXG4gIFRpbWVTaGVldEFwcC5jb250cm9sbGVyICdEYXNoQm9hcmRDb250cm9sbGVyJywgRGFzaEJvYXJkQ29udHJvbGxlclxuXG4gIERhc2hCb2FyZENvbnRyb2xsZXIiXX0=
